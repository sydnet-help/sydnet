---
title: "SOC830 Lab 3: Playing with Variables"

lastmod: 2018-12-28T00:00:00.000Z

draft: false
type: docs
maths: true

output:
  blogdown::html_page:
    toc: true

linktitle: "Lab 3: Playing with Variables"
menu:
  docs:
    parent: SOC830(SOCI702)
    weight: 20
---
The third lab session covers the following:

* How to make variables
* How to assign variable labels
* How to assign value labels
* How to save datasets

We continue working on the dataset we created in the last lab. Open RStudio, and you will see the R file you made in the last lab. If you do not see your R file, go to **File >> Open File...** in the top menu. And open it from your working directory. Then, run all the codes you wrote in the previous lab. You will see _**mydata**_ in the tab of **Environment**.

Now, you are ready to learn new codes.

```{r, echo=FALSE}
mydata <- read.csv(url("https://github.com/hylee87/surveyclass/raw/master/data/SOC830_lab2_data_02.csv"))
```


# Playing with variables
## R is a calculator.
Just think of R as a calculator. It can compute elementary equations. Examples are:

```{r, echo=TRUE}
250 + 125
250 - 125
250 * 125
250/125
```

As expected, R can do complicated equations as well. The example below computes ${e}^{5}+\sqrt{\frac{\ln{253}+\pi}{653-258}}$.

```{r, echo=TRUE}
exp(5)+sqrt((log(253) + pi)/(653-258))
```

If you want to learn more about basic mathematical operations in R, go to [Basic Operations in R Tutorial](https://www.cyclismo.org/tutorial/R/basicOps.html#basic-operations).

## How to make variables {#variables}
In R, variables can take several forms. In this lab, we will cover only 1) numbers, 2) characters, and 3) data frames that are essential for the course. If you want to study more about variables in R, go to [Variable Types in R Tutorial](https://www.cyclismo.org/tutorial/R/types.html#variable-types).
A variable could be a single number. For instance, we can assign 3 to variable _a_.

```{r, echo=TRUE}
a <- 5
```

The “<-” tells R to assign the number to the right of the symbol (in this case, a). If you want to see numbers assigned to variables, type the variable name and run it. It will show the numbers.

```{r, echo=TRUE}
a
```

R can assign the outcomes of mathematical operations to variables. For example,

```{r, echo=TRUE}
b <- a * a + 3
b
```

Now, we finished assigning numbers to two variables. Can you guess what the outcome will be if we add _a_ and _b_? Let's check the result.

```{r, echo=TRUE}
a + b
```

Besides, R can assign texts to variables. In R, this form of data is called characters; any value written within a pair of single or double quotes in R is treated as a character. For example,

```{r, echo=TRUE}
c <- "soc 830"
c
```

Note that you are not limited to assigning one single value. You can also make a list of values (called a vector in R) and assign it to a variable. For example, we are going to input age and gender for five respondents.

```{r, echo=TRUE}
age <- c(36, 19, 30, 55, 42)
age
gender <- c("male", "female", "female", "male", "female")
gender
```

_age_ is a list of numbers, and _gender_ is a list of characters. If you want to confirm this, run the following code:

```{r, echo=TRUE}
class(age)
class(gender)
```

Now, we will make a data frame that combines _age_ and _gender_ that we just created.

```{r, echo=TRUE}
data <- cbind(age, gender)
data <- as.data.frame(data)
```

Let's check the data frame we just made and also the type of variable.

```{r, echo=TRUE}
data
class(data)
```

## How to remove variables we made so far.

So far, we have made seven variables: _mydata_, _a_, _b_, _c_, _age_, _gender_, and _data_. However, we will keep only _mydata_ which will be used for the remaining lab.
If you want to remove only one variable, use '`rm(variable name)`'. For example,

```{r, echo=TRUE}
rm(a)
```

If you want to remove multiple variables, use '`rm(variable name 1, variable name 2, variable name 3, ...)`'. For example,

```{r, echo=TRUE}
rm(b, c, age, gender, data)
```

Check the tab of Environment. You will see the variables you specified are removed.

# Assigning labels and value labels to the AuSSa subsample dataset
The remaining lab will work on the AuSSA subsample dataset we created in the previous lab. We will assign labels and value labels to each variable. 

## Loading packages
For labelling data, we need to use two packages which I recommended to install in the lab 2: _sjlabelled_ and _sjmisc_. To load them in R, run the following codes:

```{r eval=TRUE, echo=FALSE}
library(sjlabelled)
library(sjmisc) 
```

```{r eval=FALSE, echo=TRUE}
library(sjlabelled)
library(sjmisc) 
```

Every time you want to use packages, you need to run '`library(package name)`'. Otherwise, you will see a warning message that says "_could not find function_".

## How to access variables in a data frame.
A data frame consists of many variables. For instance, _mydata_ consists of five variables: _id_, _sex_, _age_, _polorient_, _class_. We learned how to see a data frame (if you are not sure, review [How to make variables](#variables)). But we do not know how to see a specific variable in a data frame. To access it, use '`data frame name$variable name`'. For example, the following codes will show each of four variables in _mydata_.

```{r, echo=TRUE}
mydata$sex
mydata$age  
mydata$polorient
mydata$class
```

## How to add variable labels
It is recommended to add short descriptions of variables which I call variable labels. We often set variable names in a simple way such as _polorient_. Consequently, it is easy to forget what variables are about after a while. In that case, variable labels will be helpful for recalling them. 
First, check the variable label of _id_. '`get_label(data name$variable name)`' will show a variable label.

```{r, echo=TRUE}
get_label(mydata$id)
```

Expectedly, it shows nothing. Let's assign the variable label of _id_.

```{r, echo=TRUE}
mydata$id <- set_label(mydata$id, label = "Identification Number")
get_label(mydata$id)
```

'`data name$variable name <- set_label(data name$variable name, label = "variable label")`'
will assign variable labels to specified variables. After assigning it, '`get_label`' function will show a newly assigned variable label.

Let's assign variable labels to the others as well.

```{r, echo=TRUE}
mydata$sex <- set_label(mydata$sex, label = "Gender")
mydata$age <- set_label(mydata$age, label = "Age")
mydata$polorient <- set_label(mydata$polorient, label = "Political Orientation")
mydata$class <- set_label(mydata$class, label = "Social Class")
```

## How to add value labels

When we created the dataset in lab 2, we inputted numbers instead of texts. Nonetheless, the number itself has no meaning except for _age_. Therefore, it is recommended to assign a (category) label to each value (number). Category information of each variable can be found in [Lab 2: How to enter data manually](https://methods101.com/docs/soc830_lab_02/#how-to-enter-data-manually). For example, in _sex_ "Male" will be assigned to 1, and "Female" will be assigned to 2. We will use '`set_labels`' function for this purpose. The R code is '`data name$variable name <- set_labels(data name$variable name, labels = c("category 1" = value 1, "category 2" = value 2, ...))`'.

```{r, echo=TRUE}
mydata$sex <- set_labels(mydata$sex, labels = c("male" = 1, "female" = 2))
```

Then, let's assign value labels to _polorient_ and _class_ as well.

```{r, echo=TRUE}
mydata$polorient <- set_labels(mydata$polorient, 
                               labels = c("Far left" = 1,
                                          "Left" = 2,
                                          "Center" = 3,
                                          "Right" = 4,
                                          "Far right" = 5))
mydata$class <- set_labels(mydata$class, labels = c("Lower class" = 1,
                                                   "Working class" = 2,
                                                   "Lower middle class" = 3,
                                                   "Middle class" = 4,
                                                   "Upper middle class" = 5,
                                                   "Upper class" = 6))
```

Now is the time to check whether you followed all the steps so far correctly. We will make frequency tables of _sex_, _polorient_ and _class_ using '`frq`' function (you will learn more about this function in lab 5). If you followed well, you will see the variable and value labels of the tree variables.

```{r, echo=TRUE}
frq(mydata$sex)
frq(mydata$polorient)
frq(mydata$class)
```

## Saving data into RDS format
Now, we have a complete dataset. So, we will save it for future use. There are multiple ways to save datasets in R. However, I recommend to save them in RDS format because this format preserves data structure and reduces the size of files considerably. The R code for this job is '`saveRDS(data name, file = "file-name.rds")`'. Note that the file name should end with ".rds".

```{r, echo=TRUE}
saveRDS(mydata, file = "mydata.rds")
```

After running this code, look at your working directory. You will see "mydata.rds" there. Also, do not forget to save this R file as well. If you click on the icon of disk in the text editor, your R file will be saved.

The next lab will introduce how to import this file into R. So, please keep this file.

The R codes you have written so far look like:

```{r eval=FALSE, echo=TRUE}
################################################################################
# Title: Lab 2 & 3
# Date: 18/03/2019
################################################################################

# Import CSV files
mydata <- read.csv("table-1-30-respondents.csv")
mydata

# Elementary equations
250 + 125
250 - 125
250 * 125
250/125

# A complicated equation
exp(5)+sqrt((log(253) + pi)/(653-258))

# Make variables
a <- 5
a
b <- a * a + 3
b
a + b
c <- "soc 830"
c

# Create vectors
age <- c(36, 19, 30, 55, 42)
age
gender <- c("male", "female", "female", "male", "female")
gender

class(age)
class(gender)

# Create data frames
data <- cbind(age, gender)
data <- as.data.frame(data)
data
class(data)

# How to remove variables
rm(a)
rm(b, c, age, gender, data)

# Load package
library(sjlabelled)
library(sjmisc) 

# How to access variables in data frame
mydata$sex
mydata$age  
mydata$polorient
mydata$class

# How to add variable labels
get_label(mydata$id)
mydata$id <- set_label(mydata$id, label = "Identification Number")
get_label(mydata$id)

mydata$sex <- set_label(mydata$sex, label = "Gender")
mydata$age <- set_label(mydata$age, label = "Age")
mydata$polorient <- set_label(mydata$polorient, label = "Political Orientation")
mydata$class <- set_label(mydata$class, label = "Social Class")

# How to add value labels 
mydata$sex <- set_labels(mydata$sex, labels = c("male" = 1, "female" = 2))
mydata$polorient <- set_labels(mydata$polorient, 
                               labels = c("Far left" = 1,
                                          "Left" = 2,
                                          "Center" = 3,
                                          "Right" = 4,
                                          "Far right" = 5))
mydata$class <- set_labels(mydata$class, labels = c("Lower class" = 1,
                                                   "Working class" = 2,
                                                   "Lower middle class" = 3,
                                                   "Middle class" = 4,
                                                   "Upper middle class" = 5,
                                                   "Upper class" = 6))

# Let me check whether all the steps so far have made differences.
# The following codes will show frequency tables along with variable names and value labels.
frq(mydata$sex)
frq(mydata$polorient)
frq(mydata$class)

# Saving data into RDS format
saveRDS(mydata, file = "mydata.rds")

# Do not forget to save this R file.
```

<center>
Last updated on _`r format(Sys.time(), '%d %B, %Y')`_ by _Dr Hang Young Lee_[(hangyoung.lee@mq.edu.au)](mailto:hangyoung.lee@mq.edu.au)
</center>

